<main class="layer-stack" [class.is-loading]="isLoading$ | async">
  <ng-container *ngIf="(isLoading$ | async) === true">
    <div class="loading-overlay" role="status" aria-live="polite" aria-label="Loading 3D assets">
      <div class="loader">
        {{ ((progress$ | async) ?? 0) | number:'1.0-0' }}%
      </div>
    </div>
  </ng-container>

  <section class="layer layer--background" aria-hidden="true">
    <app-sphere></app-sphere>
  </section>

  <section class="layer layer--foreground">
    <div
      class="route-viewport"
      [class.route-viewport--scroll]="scrollMode(outlet) !== null"
      [class.route-viewport--scroll-narrow]="scrollMode(outlet) === 'narrow'"
      [class.route-viewport--interactive]="isInteractive(outlet)"
      (@crossFadeAnimation.start)="onRouteAnimStart($event)"
      (@crossFadeAnimation.done)="onRouteAnimDone()"
      [@crossFadeAnimation]="prepareRoute(outlet)"
    >
      <router-outlet #outlet="outlet"></router-outlet>
    </div>
  </section>

  <ng-container *ngIf="!isHeaderHidden(outlet)">
    <app-header-ribbon></app-header-ribbon>
  </ng-container>

<app-footer-ribbon></app-footer-ribbon>
</main>
